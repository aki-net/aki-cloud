{{- if .NameServers -}}
.:53 {
{{- range .BindIPs }}
    bind {{ . }}
{{- end }}
    errors
    bufsize {{ .BufSize }}
    minimal
    loadbalance
    cache {
        success {{ .CacheSuccessTTL }}
        denial {{ .CacheDenialTTL }}
    }
    any
{{- if .QueryLog }}
    log . {
        class {{ .QueryLogClass }}
    }
{{- end }}
{{- range .Zones }}
    file {{ $.ZonesDir }}/{{ .FileName }} {{ .Domain }} {
        reload 5s
    }
{{- end }}
}
{{- else -}}
.:53 {
    errors
    bufsize {{ .BufSize }}
    minimal
    loadbalance
    cache {
        success {{ .CacheSuccessTTL }}
        denial {{ .CacheDenialTTL }}
    }
    any
{{- if .QueryLog }}
    log . {
        class {{ .QueryLogClass }}
    }
{{- end }}
}
{{- end -}}
